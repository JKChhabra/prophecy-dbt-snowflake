{"id":"macro_tests","metainfo":{"label":"macro_tests","finalProcessID":"DLWHhSvurqsWqorlzR84K$$xzIWybgfRvkenjd0qdFt7","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"AmountByCustomer##bWwvNfVq":{"id":"AmountByCustomer##bWwvNfVq","component":"Aggregate","metadata":{"label":"AmountByCustomer","x":720,"y":320,"phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"USER_ID"},"alias":"USER_ID"},{"expression":{"expression":"sum(AMOUNT)"},"alias":"AMOUNT"},{"expression":{"expression":"max(ORDER_DATE)"},"alias":"ORDER_DATE"},{"expression":{"expression":"ANY_VALUE(FULL_NAME)"},"alias":"FULL_NAME"},{"expression":{"expression":"sum(AMOUNT_CENTS)"},"alias":"AMOUNT_CENTS"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"USER_ID"}}]},"ports":{"inputs":[{"id":"l62kll77","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"AMOUNT_CENTS","dataType":{"type":"Number"}}]},"slug":"byCustomer"}],"outputs":[{"id":"mZzIww1s","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"AMOUNT_CENTS","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"raw_customers##MsYsl8Lv":{"id":"raw_customers##MsYsl8Lv","component":"Seed","metadata":{"label":"raw_customers","x":320,"y":420,"phase":0},"properties":{"table":{"name":"raw_customers","sourceType":"Seed"}},"ports":{"inputs":[],"outputs":[{"id":"upTVagcW","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"byOrder##QC1mZbMn":{"id":"byOrder##QC1mZbMn","component":"Join","metadata":{"label":"byOrder","x":320,"y":220,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"in1","expression":{"expression":"raw_payments.order_id = in1.id"},"joinType":"INNER"}],"expressions":[{"expression":{"expression":"raw_payments.payment_method"},"alias":"payment_method"},{"expression":{"expression":"raw_payments.amount"},"alias":"amount"},{"expression":{"expression":"in1.order_date"},"alias":"order_date"},{"expression":{"expression":"in1.status"},"alias":"status"},{"expression":{"expression":"raw_payments.order_id"},"alias":"order_id"},{"expression":{"expression":"in1.user_id"},"alias":"user_id"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"raw_payments"},"ports":{"inputs":[{"id":"hEcyemw2","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"order_id","dataType":{"type":"Number"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Number"}}]},"slug":"raw_payments"},{"id":"UI0qpZSM","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"user_id","dataType":{"type":"Number"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"in1"}],"outputs":[{"id":"Zv49LH9i","schema":{"providerType":"Snowflake","fields":[{"name":"PAYMENT_METHOD","dataType":{"type":"String"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"USER_ID","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"raw_payments##mVcQUEJw":{"id":"raw_payments##mVcQUEJw","component":"Seed","metadata":{"label":"raw_payments","x":120,"y":120,"phase":0},"properties":{"table":{"name":"raw_payments","sourceType":"Seed"}},"ports":{"inputs":[],"outputs":[{"id":"kihOjRf5","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"order_id","dataType":{"type":"Number"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"byCustomer##OOI1S8P8":{"id":"byCustomer##OOI1S8P8","component":"Join","metadata":{"label":"byCustomer","x":520,"y":320,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"in1","expression":{"expression":"in0.USER_ID = in1.id"},"joinType":"INNER"}],"expressions":[{"expression":{"expression":"in0.USER_ID"},"alias":"USER_ID"},{"expression":{"expression":"in0.AMOUNT"},"alias":"AMOUNT"},{"expression":{"expression":"in0.ORDER_DATE"},"alias":"ORDER_DATE"},{"expression":{"expression":"CALCULATE_FULL_NAME(in1.first_name, '', in1.last_name)"},"alias":"full_name"},{"expression":{"expression":"{{ dollars_to_cents('in0.AMOUNT') }}"},"alias":"AMOUNT_CENTS"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"in0"},"ports":{"inputs":[{"id":"soaOEhDJ","schema":{"providerType":"Snowflake","fields":[{"name":"PAYMENT_METHOD","dataType":{"type":"String"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"USER_ID","dataType":{"type":"Number"}}]},"slug":"in0"},{"id":"AWoBIKgS","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"in1"}],"outputs":[{"id":"WQaq1lg1","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"AMOUNT_CENTS","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"DLWHhSvurqsWqorlzR84K$$xzIWybgfRvkenjd0qdFt7":{"id":"DLWHhSvurqsWqorlzR84K$$xzIWybgfRvkenjd0qdFt7","component":"Reformat","metadata":{"label":"HumanReadableAmount","slug":"HumanReadableAmount","x":940,"y":300,"phase":0,"macroDependencies":["human_readable_number"]},"properties":{"columnsSelector":["aJgLG1y4OFoPbYEYQSeIE$$QLm8uBIhn2R3x7DfIafnE##USER_ID","aJgLG1y4OFoPbYEYQSeIE$$QLm8uBIhn2R3x7DfIafnE##AMOUNT","aJgLG1y4OFoPbYEYQSeIE$$QLm8uBIhn2R3x7DfIafnE##ORDER_DATE","aJgLG1y4OFoPbYEYQSeIE$$QLm8uBIhn2R3x7DfIafnE##FULL_NAME","aJgLG1y4OFoPbYEYQSeIE$$QLm8uBIhn2R3x7DfIafnE##AMOUNT_CENTS"],"expressions":[{"expression":{"expression":"USER_ID"},"alias":"USER_ID"},{"expression":{"expression":"AMOUNT"},"alias":"AMOUNT"},{"expression":{"expression":"ORDER_DATE"},"alias":"ORDER_DATE"},{"expression":{"expression":"FULL_NAME"},"alias":"FULL_NAME"},{"expression":{"expression":"AMOUNT_CENTS"},"alias":"AMOUNT_CENTS"},{"expression":{"expression":"{{ human_readable_number('AMOUNT_CENTS') }}"},"alias":"HUMAN_AMOUNT_CENTS"},{"expression":{"expression":"{{ human_readable_number('AMOUNT') }}"},"alias":"HUMAN_AMOUNT"}]},"ports":{"inputs":[{"id":"aJgLG1y4OFoPbYEYQSeIE$$QLm8uBIhn2R3x7DfIafnE","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"AMOUNT_CENTS","dataType":{"type":"Number"}}]},"slug":"AmountByCustomer"}],"outputs":[{"id":"XbCdrhXSIaRLyWKLquWbX$$6GKDvoJzb0YfZZy3f_sx3","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"AMOUNT_CENTS","dataType":{"type":"Number"}},{"name":"HUMAN_AMOUNT_CENTS","dataType":{"type":"String"}},{"name":"HUMAN_AMOUNT","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"raw_orders##uGZbqp9d":{"id":"raw_orders##uGZbqp9d","component":"Seed","metadata":{"label":"raw_orders","x":120,"y":320,"phase":0},"properties":{"table":{"name":"raw_orders","sourceType":"Seed"}},"ports":{"inputs":[],"outputs":[{"id":"BFzWqnD2","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"user_id","dataType":{"type":"Number"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"FMVQbOPN","source":"raw_payments##mVcQUEJw","sourcePort":"kihOjRf5","target":"byOrder##QC1mZbMn","targetPort":"hEcyemw2"},{"id":"kd1pOFhP","source":"raw_orders##uGZbqp9d","sourcePort":"BFzWqnD2","target":"byOrder##QC1mZbMn","targetPort":"UI0qpZSM"},{"id":"pPh5yq92","source":"byOrder##QC1mZbMn","sourcePort":"Zv49LH9i","target":"byCustomer##OOI1S8P8","targetPort":"soaOEhDJ"},{"id":"AtZhWYjw","source":"raw_customers##MsYsl8Lv","sourcePort":"upTVagcW","target":"byCustomer##OOI1S8P8","targetPort":"AWoBIKgS"},{"id":"jjafJDKN","source":"byCustomer##OOI1S8P8","sourcePort":"WQaq1lg1","target":"AmountByCustomer##bWwvNfVq","targetPort":"l62kll77"},{"id":"OQI0fiRCqQ-zlTSdbt6vr$$W9W-oQXZrzivR4sIwhupn","source":"AmountByCustomer##bWwvNfVq","sourcePort":"mZzIww1s","target":"DLWHhSvurqsWqorlzR84K$$xzIWybgfRvkenjd0qdFt7","targetPort":"aJgLG1y4OFoPbYEYQSeIE$$QLm8uBIhn2R3x7DfIafnE"}],"component":"Model"}