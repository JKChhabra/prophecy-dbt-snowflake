{"id":"customer_reports","metainfo":{"label":"customer_reports","finalProcessID":"K8wA8o6d-NgdWV8esikgD$$Aw8SC8vxUR75gLnEX0oDU","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"K8wA8o6d-NgdWV8esikgD$$Aw8SC8vxUR75gLnEX0oDU":{"id":"K8wA8o6d-NgdWV8esikgD$$Aw8SC8vxUR75gLnEX0oDU","component":"Limit","metadata":{"label":"Top10","slug":"Top10","x":960,"y":220,"phase":0,"macroDependencies":[]},"properties":{"limit":{"expression":"10"}},"ports":{"inputs":[{"id":"W-CAL4Yj3J6Gq211Dbeqg$$yy6d3CFXyoUNS3NLiJMND","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"in0"}],"outputs":[{"id":"eljwX_yBhMCqGiI4BMyul$$YAFKkrX8YytUptyRRZMAo","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"CUSTOMERS##srz0Aggm":{"id":"CUSTOMERS##srz0Aggm","component":"Source","metadata":{"label":"CUSTOMERS","x":120,"y":320,"phase":0},"properties":{"table":{"name":"CUSTOMERS","sourceType":"Source","sourceName":"JAFFLE_SHOP.PUBLIC"}},"ports":{"inputs":[],"outputs":[{"id":"PqA85XqW","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"ORDERS##yuNJnL3a":{"id":"ORDERS##yuNJnL3a","component":"Source","metadata":{"label":"ORDERS","x":120,"y":120,"phase":0},"properties":{"table":{"name":"ORDERS","sourceType":"Source","sourceName":"JAFFLE_SHOP.PUBLIC"}},"ports":{"inputs":[],"outputs":[{"id":"mAkoGLlE","schema":{"providerType":"Snowflake","fields":[{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"CREDIT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"COUPON_AMOUNT","dataType":{"type":"Number"}},{"name":"BANK_TRANSFER_AMOUNT","dataType":{"type":"Number"}},{"name":"GIFT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"AmountByCustomer##MasytVVr":{"id":"AmountByCustomer##MasytVVr","component":"Aggregate","metadata":{"label":"AmountByCustomer","x":520,"y":220,"phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"SUM(AMOUNT)"},"alias":"AMOUNT"},{"expression":{"expression":"CUSTOMER_ID"},"alias":"CUSTOMER_ID"},{"expression":{"expression":"MAX(ORDER_DATE)"},"alias":"ORDER_DATE"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"CUSTOMER_ID"}}]},"ports":{"inputs":[{"id":"NnS8MTpB","schema":{"providerType":"Snowflake","fields":[{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"COUPON_AMOUNT","dataType":{"type":"Number"}},{"name":"CREDIT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"BANK_TRANSFER_AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"GIFT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}}]},"slug":"in0"}],"outputs":[{"id":"igi1Gk4H","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"TopCustomers##Q7lExxyL":{"id":"TopCustomers##Q7lExxyL","component":"OrderBy","metadata":{"label":"TopCustomers","x":740,"y":220,"phase":0,"macroDependencies":[]},"properties":{"columnsSelector":["eaRxNhMD##AMOUNT"],"orders":[{"expression":{"expression":"AMOUNT"},"sortType":"desc","nullsType":"nulls last"}]},"ports":{"inputs":[{"id":"eaRxNhMD","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"in0"}],"outputs":[{"id":"A9hrPwpK","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"byCustomerId##lZeBCNYJ":{"id":"byCustomerId##lZeBCNYJ","component":"Join","metadata":{"label":"byCustomerId","x":320,"y":220,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"CUSTOMERS","expression":{"expression":"ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID"},"joinType":"INNER"}],"expressions":[{"expression":{"expression":"CUSTOMERS.FIRST_ORDER"},"alias":"FIRST_ORDER"},{"expression":{"expression":"CUSTOMERS.MOST_RECENT_ORDER"},"alias":"MOST_RECENT_ORDER"},{"expression":{"expression":"CUSTOMERS.NUMBER_OF_ORDERS"},"alias":"NUMBER_OF_ORDERS"},{"expression":{"expression":"ORDERS.CUSTOMER_ID"},"alias":"CUSTOMER_ID"},{"expression":{"expression":"ORDERS.COUPON_AMOUNT"},"alias":"COUPON_AMOUNT"},{"expression":{"expression":"ORDERS.CREDIT_CARD_AMOUNT"},"alias":"CREDIT_CARD_AMOUNT"},{"expression":{"expression":"ORDERS.ORDER_ID"},"alias":"ORDER_ID"},{"expression":{"expression":"ORDERS.STATUS"},"alias":"STATUS"},{"expression":{"expression":"ORDERS.BANK_TRANSFER_AMOUNT"},"alias":"BANK_TRANSFER_AMOUNT"},{"expression":{"expression":"ORDERS.ORDER_DATE"},"alias":"ORDER_DATE"},{"expression":{"expression":"ORDERS.GIFT_CARD_AMOUNT"},"alias":"GIFT_CARD_AMOUNT"},{"expression":{"expression":"ORDERS.AMOUNT"},"alias":"AMOUNT"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"ORDERS"},"ports":{"inputs":[{"id":"lG3bFptq","schema":{"providerType":"Snowflake","fields":[{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"CREDIT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"COUPON_AMOUNT","dataType":{"type":"Number"}},{"name":"BANK_TRANSFER_AMOUNT","dataType":{"type":"Number"}},{"name":"GIFT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}}]},"slug":"ORDERS"},{"id":"BUTRpXFr","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}}]},"slug":"CUSTOMERS"}],"outputs":[{"id":"v22eHyk4","schema":{"providerType":"Snowflake","fields":[{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"COUPON_AMOUNT","dataType":{"type":"Number"}},{"name":"CREDIT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"BANK_TRANSFER_AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"GIFT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"Z8QU9fkg","source":"ORDERS##yuNJnL3a","sourcePort":"mAkoGLlE","target":"byCustomerId##lZeBCNYJ","targetPort":"lG3bFptq"},{"id":"xcUse90X","source":"CUSTOMERS##srz0Aggm","sourcePort":"PqA85XqW","target":"byCustomerId##lZeBCNYJ","targetPort":"BUTRpXFr"},{"id":"lO4uc171","source":"byCustomerId##lZeBCNYJ","sourcePort":"v22eHyk4","target":"AmountByCustomer##MasytVVr","targetPort":"NnS8MTpB"},{"id":"O665MPp1","source":"AmountByCustomer##MasytVVr","sourcePort":"igi1Gk4H","target":"TopCustomers##Q7lExxyL","targetPort":"eaRxNhMD"},{"id":"_3WoR30KhH_ttYLX9qrCR","source":"TopCustomers##Q7lExxyL","sourcePort":"A9hrPwpK","target":"K8wA8o6d-NgdWV8esikgD$$Aw8SC8vxUR75gLnEX0oDU","targetPort":"W-CAL4Yj3J6Gq211Dbeqg$$yy6d3CFXyoUNS3NLiJMND"}],"component":"Model"}